<!DOCTYPE html>
<html lang="en">
<head>
    <title>CWC-ITGlue</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.7/es5-sham.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/json3/3.3.2/json3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.34.2/es6-shim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.34.2/es6-sham.min.js"></script>
    <!--    <script src="https://cdnjs.cloudflare.com/ajax/libs/es7-shim/6.0.0/es7-shim.min.js"></script>-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <!-- Bootstrap CSS and JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css"
          integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
            integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
</head>
<body>
<div id="app">
    <nav class="navbar navbar-inverse">
        <div class="container">
            <div class="navbar-header navbar-brand">
                ITGlue Helper
            </div>
        </div>
    </nav>
    <div class="container-fluid hidden" id="login-form">
        <div class="col-xs-6 col-xs-offset-2">
            <div id="login-alert" class="alert alert-warning alert-dismissible hidden">
                <button type="button" class="close" data-dismiss="alert"><span>&times;</span></button>
                <p></p>
            </div>
            <div class="page-header">Login</div>
            <form class="form-group-xs">
                <div class="form-group">
                    <label class="control-label">
                        Company URL
                        <input name="companyUrl" type="text" placeholder="Company URL" class="form-control">
                    </label>
                </div>
                <div class="form-group">
                    <label class="control-label">
                        Email
                        <input name="email" type="text" placeholder="Email" class="form-control">
                    </label>
                </div>
                <div class="form-group">
                    <label class="control-label">
                        Password
                        <input name="password" type="password" placeholder="Password" class="form-control">
                    </label>
                </div>
                <div class="form-group">
                    <label class="control-label">
                        MFA Code
                        <input name="otp" type="password" placeholder="MFA Code" class="form-control">
                    </label>
                </div>
                <button type="submit" class="btn btn-primary" id="login-button">Log in</button>
            </form>
        </div>
    </div>
    <div class="container-fluid hidden" id="client-select">
        <form role="form">
            <div class="form-group">
                <label>Organization
                    <input class="form-control" id="organization-search" type="text">
                </label>
            </div>
        </form>
    </div>
    <div class="container-fluid hidden" id="client-passwords">
        <table class="table table-hover">
            <thead>
            <tr>
                <th>Name</th>
                <th>Username</th>
                <th>Category</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
    <div class="container-fluid">
        <p>results:</p>
        <div id="results"></div>
        <p>state:</p>
        <div id="state-log"></div>
    </div>
    <button class="btn btn-danger" id="clear-local-storage">Clear Local Settings (dev only)</button>
</div>
<script type="text/javascript">!function(n){var o={};function i(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}i.m=n,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e){t.exports=jQuery},function(t,e,n){"use strict";n(2);var a=i(n(0));n(3);var r=n(4),o=i(n(7)),h=n(8);function i(t){return t&&t.__esModule?t:{"default":t}}var u,s,l,c,d,p,f,m,y={token:undefined,loginFail:!1,loggedIn:!1,organizations:[],organizationsLoaded:!1,organizationShortNames:[],organizationSelected:undefined,organizationPasswords:[],organizationPasswordsLoaded:!1},g=new o["default"](y);function v(t){var e=t.oldState,n=t.newState;if(n.loggedIn?u.addClass("hidden"):u.removeClass("hidden"),n.loginFail?(c.removeClass("hidden"),(0,a["default"])("#login-alert p").text("Login failure.")):c.addClass("hidden"),n.organizationsLoaded?(d.removeClass("hidden"),p.typeahead({source:n.organizationShortNames,afterSelect:function(t){return function o(e){var n;g.state.organizations.forEach(function(t){t.attributes["short-name"]===e&&(n=t)}),g.setState({organizationSelected:n})}(t)}})):(p.typeahead("destroy"),d.addClass("hidden")),n.organizationSelected&&!e.organizationSelected&&function i(t){var e=t.id;(0,r.getOrganizationPasswords)(m,e).then(function(t){var e=(t.data||[]).map(function(t){var e=t.id,n=t.attributes;return{id:e,name:n.name,category:n["password-category-name"],username:n.username}});g.setState({organizationPasswords:e,organizationPasswordsLoaded:!0})})["catch"](function(t){console.log("error loading passwords",t)})}(n.organizationSelected),n.organizationPasswordsLoaded&&!e.organizationPasswordsLoaded){f.removeClass("hidden");var o=["name","username","category",h.SEND_CREDENTIALS];!function s(t,e,o){var i=(0,a["default"])("<tbody>");e.forEach(function(e){var n=(0,a["default"])("<tr>");o.forEach(function(t){t===h.SEND_CREDENTIALS?n.append((0,a["default"])("<td>").append((0,a["default"])('<button class="btn btn-info">').text("Send").data("id",e.id).on("click",S))):n.append((0,a["default"])("<td>").text(e[t]))}),i.append(n)}),t.append(i)}((0,a["default"])("#client-passwords table"),n.organizationPasswords,o)}else f.addClass("hidden")}function b(t){t.preventDefault(),window.localStorage.clear(),g.setState(y)}function w(t){t.preventDefault();var e=(0,a["default"])("input[name=companyUrl]").val(),n=(0,a["default"])("input[name=email]").val(),o=(0,a["default"])("input[name=password]").val(),i=(0,a["default"])("input[name=otp]").val();(0,r.itgLogin)(e,n,o,i).then(function(t){s.append((0,a["default"])("<div>").text(JSON.stringify(t,null,2))),g.setState({loggedIn:!0,loginFail:!1}),(0,r.setCookie)(h.SETTING_TOKEN,t),k()})["catch"](function(t){s.append((0,a["default"])("<div>").text(JSON.stringify(t,null,2))),g.setState({token:undefined,loggedIn:!1,loginFail:!0}),(0,r.setCookie)(h.SETTING_TOKEN,undefined)})}function k(){(0,r.getOrganizations)(m).then(function(t){console.log(t),g.setState({organizations:t.data||[],organizationsLoaded:!0,organizationShortNames:t.data.map(function(t){return t.attributes["short-name"]})})})["catch"](function(t){console.log(t)})}function S(t){var e=(0,a["default"])(t.target).data("id");(0,r.getPassword)(m,g.state.organizationSelected.id,e).then(function(t){console.log("password",t);var e=t.attributes,n=e.username,o=e.password;(0,r.sendCredentials)(n,o)})["catch"](function(t){console.log("error loading password",t)})}(0,a["default"])(document).on("ready",function(){g.on("change",v),u=(0,a["default"])("#login-form"),s=(0,a["default"])("#results"),(0,a["default"])("#state-log"),l=(0,a["default"])("#login-button"),c=(0,a["default"])("#login-alert"),d=(0,a["default"])("#client-select"),p=(0,a["default"])("#organization-search"),f=(0,a["default"])("#client-passwords"),m=(0,r.getCookie)(h.SETTING_TOKEN),g.setState({token:m}),l.on("click",w),(0,a["default"])("#clear-local-storage").on("click",b),function t(){m&&0<m.length?(console.log("saved token detected, verifying"),(0,r.verifyToken)(m).then(function(t){console.log("verify result",t),t?(g.setState({token:m,loggedIn:!0,loginFail:!1}),k()):(g.setState({token:undefined,loggedIn:!1,loginFail:!0}),(0,r.deleteCookie)(h.SETTING_TOKEN))})["catch"](function(t){console.log("verify error",t),g.setState({token:undefined,loggedIn:!1,loginFail:!0})})):u.removeClass("hidden")}()})},function(t,e){!function(t){"use strict";t.console||(t.console={});for(var e,n,o=t.console,i=function(){},s=["memory"],a="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");e=s.pop();)o[e]||(o[e]={});for(;n=a.pop();)o[n]||(o[n]=i)}("undefined"==typeof window?this:window)},function(t,e,n){"use strict";var o,i,s;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}s=function(h){var s=function s(t,e){this.$element=h(t),this.options=h.extend({},s.defaults,e),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"!=typeof this.options.autoSelect||this.options.autoSelect,this.highlighter=this.options.highlighter||this.highlighter,this.render=this.options.render||this.render,this.updater=this.options.updater||this.updater,this.displayText=this.options.displayText||this.displayText,this.itemLink=this.options.itemLink||this.itemLink,this.itemTitle=this.options.itemTitle||this.itemTitle,this.followLinkOnSelect=this.options.followLinkOnSelect||this.followLinkOnSelect,this.source=this.options.source,this.delay=this.options.delay,this.theme=this.options.theme&&this.options.themes&&this.options.themes[this.options.theme]||s.defaults.themes[s.defaults.theme],this.$menu=h(this.options.menu||this.theme.menu),this.$appendTo=this.options.appendTo?h(this.options.appendTo):null,this.fitToElement="boolean"==typeof this.options.fitToElement&&this.options.fitToElement,this.shown=!1,this.listen(),this.showHintOnFocus=("boolean"==typeof this.options.showHintOnFocus||"all"===this.options.showHintOnFocus)&&this.options.showHintOnFocus,this.afterSelect=this.options.afterSelect,this.afterEmptySelect=this.options.afterEmptySelect,this.addItem=!1,this.value=this.$element.val()||this.$element.text(),this.keyPressed=!1,this.focused=this.$element.is(":focus"),this.changeInputOnSelect=this.options.changeInputOnSelect||this.changeInputOnSelect,this.changeInputOnMove=this.options.changeInputOnMove||this.changeInputOnMove,this.openLinkInNewTab=this.options.openLinkInNewTab||this.openLinkInNewTab,this.selectOnBlur=this.options.selectOnBlur||this.selectOnBlur,this.showCategoryHeader=this.options.showCategoryHeader||this.showCategoryHeader};s.prototype={constructor:s,setDefault:function(t){if(this.$element.data("active",t),this.autoSelect||t){var e=this.updater(t);e=e||"",this.$element.val(this.displayText(e)||e).text(this.displayText(e)||e).change(),this.afterSelect(e)}return this.hide()},select:function(){var t=this.$menu.find(".active").data("value");if(this.$element.data("active",t),this.autoSelect||t){var e=this.updater(t);e=e||"",this.changeInputOnSelect&&this.$element.val(this.displayText(e)||e).text(this.displayText(e)||e).change(),this.followLinkOnSelect&&this.itemLink(t)?(this.openLinkInNewTab?window.open(this.itemLink(t),"_blank"):document.location=this.itemLink(t),this.afterSelect(e)):this.followLinkOnSelect&&!this.itemLink(t)?this.afterEmptySelect(e):this.afterSelect(e)}else this.afterEmptySelect();return this.hide()},updater:function(t){return t},setSource:function(t){this.source=t},show:function(){var t,e=h.extend({},this.$element.position(),{height:this.$element[0].offsetHeight}),n="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight;if(this.shown?t=this.$menu:this.$appendTo?(t=this.$menu.appendTo(this.$appendTo),this.hasSameParent=this.$appendTo.is(this.$element.parent())):(t=this.$menu.insertAfter(this.$element),this.hasSameParent=!0),!this.hasSameParent){t.css("position","fixed");var o=this.$element.offset();e.top=o.top,e.left=o.left}var i=h(t).parent().hasClass("dropup")?"auto":e.top+e.height+n,s=h(t).hasClass("dropdown-menu-right")?"auto":e.left;return t.css({top:i,left:s}).show(),!0===this.options.fitToElement&&t.css("width",this.$element.outerWidth()+"px"),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){if(this.query=null!=t?t:this.$element.val(),this.query.length<this.options.minLength&&!this.options.showHintOnFocus)return this.shown?this.hide():this;var e=h.proxy(function(){h.isFunction(this.source)&&3===this.source.length?this.source(this.query,h.proxy(this.process,this),h.proxy(this.process,this)):h.isFunction(this.source)?this.source(this.query,h.proxy(this.process,this)):this.source&&this.process(this.source)},this);clearTimeout(this.lookupWorker),this.lookupWorker=setTimeout(e,this.delay)},process:function(t){var e=this;return t=h.grep(t,function(t){return e.matcher(t)}),(t=this.sorter(t)).length||this.options.addItem?(0<t.length?this.$element.data("active",t[0]):this.$element.data("active",null),"all"!=this.options.items&&(t=t.slice(0,this.options.items)),this.options.addItem&&t.push(this.options.addItem),this.render(t).show()):this.shown?this.hide():this},matcher:function(t){return~this.displayText(t).toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var e,n=[],o=[],i=[];e=t.shift();){var s=this.displayText(e);s.toLowerCase().indexOf(this.query.toLowerCase())?~s.indexOf(this.query)?o.push(e):i.push(e):n.push(e)}return n.concat(o,i)},highlighter:function(t){var e=this.query;if(""===e)return t;var n,o=t.match(/(>)([^<]*)(<)/g),i=[],s=[];if(o&&o.length)for(n=0;n<o.length;++n)2<o[n].length&&i.push(o[n]);else(i=[]).push(t);e=e.replace(/[\(\)\/\.\*\+\?\[\]]/g,function(t){return"\\"+t});var a,r=new RegExp(e,"g");for(n=0;n<i.length;++n)(a=i[n].match(r))&&0<a.length&&s.push(i[n]);for(n=0;n<s.length;++n)t=t.replace(s[n],s[n].replace(r,"<strong>$&</strong>"));return t},render:function(n){var o=this,i=this,s=!1,a=[],r=o.options.separator;return h.each(n,function(t,e){0<t&&e[r]!==n[t-1][r]&&a.push({__type:"divider"}),this.showCategoryHeader&&(!e[r]||0!==t&&e[r]===n[t-1][r]||a.push({__type:"category",name:e[r]})),a.push(e)}),n=h(a).map(function(t,e){if("category"==(e.__type||!1))return h(o.options.headerHtml||o.theme.headerHtml).text(e.name)[0];if("divider"==(e.__type||!1))return h(o.options.headerDivider||o.theme.headerDivider)[0];var n=i.displayText(e);return(t=h(o.options.item||o.theme.item).data("value",e)).find(o.options.itemContentSelector||o.theme.itemContentSelector).addBack(o.options.itemContentSelector||o.theme.itemContentSelector).html(o.highlighter(n,e)),o.options.followLinkOnSelect&&t.find("a").attr("href",i.itemLink(e)),t.find("a").attr("title",i.itemTitle(e)),n==i.$element.val()&&(t.addClass("active"),i.$element.data("active",e),s=!0),t[0]}),this.autoSelect&&!s&&(n.filter(":not(.dropdown-header)").first().addClass("active"),this.$element.data("active",n.first().data("value"))),this.$menu.html(n),this},displayText:function(t){return void 0!==t&&void 0!==t.name?t.name:t},itemLink:function(t){return null},itemTitle:function(t){return null},next:function(t){var e=this.$menu.find(".active").removeClass("active").next();for(e.length||(e=h(this.$menu.find(h(this.options.item||this.theme.item).prop("tagName"))[0]));e.hasClass("divider")||e.hasClass("dropdown-header");)e=e.next();e.addClass("active");var n=this.updater(e.data("value"));this.changeInputOnMove&&this.$element.val(this.displayText(n)||n)},prev:function(t){var e=this.$menu.find(".active").removeClass("active").prev();for(e.length||(e=this.$menu.find(h(this.options.item||this.theme.item).prop("tagName")).last());e.hasClass("divider")||e.hasClass("dropdown-header");)e=e.prev();e.addClass("active");var n=this.updater(e.data("value"));this.changeInputOnMove&&this.$element.val(this.displayText(n)||n)},listen:function(){this.$element.on("focus.bootstrap3Typeahead",h.proxy(this.focus,this)).on("blur.bootstrap3Typeahead",h.proxy(this.blur,this)).on("keypress.bootstrap3Typeahead",h.proxy(this.keypress,this)).on("propertychange.bootstrap3Typeahead input.bootstrap3Typeahead",h.proxy(this.input,this)).on("keyup.bootstrap3Typeahead",h.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown.bootstrap3Typeahead",h.proxy(this.keydown,this));var t=h(this.options.item||this.theme.item).prop("tagName");"ontouchstart"in document.documentElement?this.$menu.on("touchstart",t,h.proxy(this.touchstart,this)).on("touchend",t,h.proxy(this.click,this)):this.$menu.on("click",h.proxy(this.click,this)).on("mouseenter",t,h.proxy(this.mouseenter,this)).on("mouseleave",t,h.proxy(this.mouseleave,this)).on("mousedown",h.proxy(this.mousedown,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.data("active",null),this.$element.unbind("focus.bootstrap3Typeahead").unbind("blur.bootstrap3Typeahead").unbind("keypress.bootstrap3Typeahead").unbind("propertychange.bootstrap3Typeahead input.bootstrap3Typeahead").unbind("keyup.bootstrap3Typeahead"),this.eventSupported("keydown")&&this.$element.unbind("keydown.bootstrap3-typeahead"),this.$menu.remove(),this.destroyed=!0},eventSupported:function(t){var e=t in this.$element;return e||(this.$element.setAttribute(t,"return;"),e="function"==typeof this.$element[t]),e},move:function(t){if(this.shown)switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:if(t.shiftKey)return;t.preventDefault(),this.prev();break;case 40:if(t.shiftKey)return;t.preventDefault(),this.next()}},keydown:function(t){17!==t.keyCode&&(this.keyPressed=!0,this.suppressKeyPressRepeat=~h.inArray(t.keyCode,[40,38,9,13,27]),this.shown||40!=t.keyCode?this.move(t):this.lookup())},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},input:function(t){var e=this.$element.val()||this.$element.text();this.value!==e&&(this.value=e,this.lookup())},keyup:function(t){if(!this.destroyed)switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:if(!this.shown||this.showHintOnFocus&&!this.keyPressed)return;this.select();break;case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide()}},focus:function(t){this.focused||(this.focused=!0,this.keyPressed=!1,this.options.showHintOnFocus&&!0!==this.skipShowHintOnFocus&&("all"===this.options.showHintOnFocus?this.lookup(""):this.lookup())),this.skipShowHintOnFocus&&(this.skipShowHintOnFocus=!1)},blur:function(t){this.mousedover||this.mouseddown||!this.shown?this.mouseddown&&(this.skipShowHintOnFocus=!0,this.$element.focus(),this.mouseddown=!1):(this.selectOnBlur&&this.select(),this.hide(),this.focused=!1,this.keyPressed=!1)},click:function(t){t.preventDefault(),this.skipShowHintOnFocus=!0,this.select(),this.$element.focus(),this.hide()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),h(t.currentTarget).addClass("active")},mouseleave:function(t){this.mousedover=!1,!this.focused&&this.shown&&this.hide()},mousedown:function(t){this.mouseddown=!0,this.$menu.one("mouseup",function(t){this.mouseddown=!1}.bind(this))},touchstart:function(t){t.preventDefault(),this.$menu.find(".active").removeClass("active"),h(t.currentTarget).addClass("active")},touchend:function(t){t.preventDefault(),this.select(),this.$element.focus()}};var t=h.fn.typeahead;h.fn.typeahead=function(o){var i=arguments;return"string"==typeof o&&"getActive"==o?this.data("active"):this.each(function(){var t=h(this),e=t.data("typeahead"),n="object"==a(o)&&o;e||t.data("typeahead",e=new s(this,n)),"string"==typeof o&&e[o]&&(1<i.length?e[o].apply(e,Array.prototype.slice.call(i,1)):e[o]())})},s.defaults={source:[],items:8,minLength:1,scrollHeight:0,autoSelect:!0,afterSelect:h.noop,afterEmptySelect:h.noop,addItem:!1,followLinkOnSelect:!1,delay:0,separator:"category",changeInputOnSelect:!0,changeInputOnMove:!0,openLinkInNewTab:!1,selectOnBlur:!0,showCategoryHeader:!0,theme:"bootstrap3",themes:{bootstrap3:{menu:'<ul class="typeahead dropdown-menu" role="listbox"></ul>',item:'<li><a class="dropdown-item" href="#" role="option"></a></li>',itemContentSelector:"a",headerHtml:'<li class="dropdown-header"></li>',headerDivider:'<li class="divider" role="separator"></li>'},bootstrap4:{menu:'<div class="typeahead dropdown-menu" role="listbox"></div>',item:'<button class="dropdown-item" role="option"></button>',itemContentSelector:".dropdown-item",headerHtml:'<h6 class="dropdown-header"></h6>',headerDivider:'<div class="dropdown-divider"></div>'}}},h.fn.typeahead.Constructor=s,h.fn.typeahead.noConflict=function(){return h.fn.typeahead=t,this},h(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var e=h(this);e.data("typeahead")||e.typeahead(e.data())})},t.exports?t.exports=s(n(0)):(o=[n(0)],(i=function(t){return s(t)}.apply(e,o))===undefined||(t.exports=i))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setCookie=function o(t,e){try{window.external.setSettingValue(t,e)}catch(n){}},e.getCookie=function s(t){var e;try{e=window.external.getSettingValue(t)}catch(n){}return e},e.deleteCookie=function a(t){try{window.external.setSettingValue(t,"")}catch(e){}},e.sendCredentials=function r(t,e){try{window.external.sendCredentials(null,t,e)}catch(n){}},e.itgLogin=function h(t,e,n,o){return new i["default"]({mode:"user",user:{email:e,password:n,otp:o},companyUrl:t}).getItGlueJsonWebToken({email:e,password:n,otp:o})},e.verifyToken=function u(t){return new i["default"]({mode:"bearer",token:t}).get({path:"/organizations"}).then(function(t){return!0})["catch"](function(t){return!1})},e.getOrganizations=function l(t){return new i["default"]({mode:"bearer",token:t}).get({path:"/organizations",params:{"page[size]":1e3,"filter[psa_integration_type]":"manage"}})},e.getOrganizationPasswords=function c(t,e){return new i["default"]({mode:"bearer",token:t}).get({path:"/organizations/".concat(e,"/relationships/passwords"),params:{"page[size]":1e3,"page[number]":1,sort:"name"}})},e.getPassword=function d(t,e,n){return new i["default"]({mode:"bearer",token:t}).get({path:"/organizations/".concat(e,"/relationships/passwords/").concat(n)}).then(function(t){return t.data})};var i=function p(t){return t&&t.__esModule?t:{"default":t}}(n(5))},function(t,e,n){"use strict";function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=n(6),d="post",p="https://api-mobile-prod.itglue.com/api",f="bearer",m="user",y="apikey";function o(t){var e=t.apikey,n=t.mode,o=void 0===n?y:n,i=(t.timeout,t.eu),s=t.companyUrl,a=t.token,r=t.user,h=(r=void 0===r?{}:r).email,u=r.password,l=r.otp;if(!s&&o===m)throw"companyUrl must be defined in mode ".concat(m);if(!a&&o===f)throw"token must be defined in mode ".concat(f);if(!e&&o===y)throw"apikey must be defined in mode ".concat(y);var c="https://api.itglue.com";i&&(c="https://api.eu.itglue.com"),this.config={async:!0,crossDomain:!0,processData:!1},this.mode=o,this.token=a,this.user={email:h,password:u,otp:l},this.apikey=e,this.companyUrl=s,this.config.headers={"cache-control":"no-cache"},o===m?(this.config.baseURL=s,this.config.headers["content-type"]="application/json"):(o===f?(this.config.baseURL=p,this.config.headers.authorization="Bearer ".concat(a)):(this.config.baseURL=c,this.config.headers["x-api-key"]=e),this.config.headers["content-type"]="application/vnd.api+json")}o.prototype.client=function(t){var i=this,s=t.path,a=t.params,r=t.body,h=t.method;return new Promise(function(e,n){var t=function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(n,!0).forEach(function(t){l(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},i.config,{url:"".concat(i.config.baseURL).concat(s,"?").concat(c(a)),method:h});h!==d&&"patch"!==h||(t.data=JSON.stringify(r)),console.log(t),$.ajax(t).done(function(t){return e(t)}).fail(function(t,e){return t&&t.responseJSON&&t.responseJSON.error_message?n(t.responseJSON.error_message):n("".concat(t.status,"/").concat(e))})})},o.prototype.handler=function(e){var n=this;return this.mode===y?this.client(e):this.mode!==m||this.token?this.mode===m&&this.token?(this.setAuthenticationMode(f),this.client(e)):this.mode===f?this.client(e):void 0:this.getItGlueJsonWebToken(this.user).then(function(t){return n.token=t,n.setAuthenticationMode(f),n.client(e)})},o.prototype.get=function(t){var e=t.path,n=t.params;return this.handler({method:"get",path:e,params:n})},o.prototype.post=function(t){var e=t.path,n=t.params,o=t.body;return this.handler({method:d,path:e,params:n,body:o})},o.prototype.patch=function(t){var e=t.path,n=t.params,o=t.body;return this.handler({method:"patch",path:e,params:n,body:o})},o.prototype["delete"]=function(t){var e=t.path,n=t.params;return this.handler({method:"delete",path:e,params:n})},o.prototype.setAuthenticationMode=function(){var t=0<arguments.length&&arguments[0]!==undefined?arguments[0]:"apikey";this.mode=t;var e=this.apikey,n=this.companyUrl,o=this.token;t===m?(this.config.baseURL=n,this.config.headers["content-type"]="application/json"):(t===f?(this.config.baseURL=p,this.config.headers.authorization="Bearer ".concat(o)):(this.config.baseURL=baseURL,this.config.headers["x-api-key"]=e),this.config.headers["content-type"]="application/vnd.api+json")},o.prototype.getItGlueJsonWebToken=function(t){var e=this,n=t.email,o=t.password,i=t.otp;return this.client({method:d,path:"/login",params:{generate_jwt:1,sso_disabled:1},body:{user:{email:n,password:o,otp_attempt:i}}}).then(function(t){return t.token}).then(function(t){return e.refreshItGlueJsonWebToken({token:t})}).then(function(t){return t})},o.prototype.refreshItGlueJsonWebToken=function(t){var e=t.token;return this.client({method:"get",path:"/jwt/token",params:{refresh_token:e}}).then(function(t){return t.token})},t.exports=o},function(e,n,t){var o;
/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */
/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */
!function(){"use strict";function t(t){function s(t,e){e=null===(e="function"==typeof e?e():e)?"":e===undefined?"":e,a[a.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)}var a=[],r=function(t,e){var n,o,i;if(t)if(Array.isArray(e))for(n=0,o=e.length;n<o;n++)r(t+"["+("object"==typeof e[n]&&e[n]?n:"")+"]",e[n]);else if("[object Object]"===String(e))for(i in e)r(t+"["+i+"]",e[i]);else s(t,e);else if(Array.isArray(e))for(n=0,o=e.length;n<o;n++)s(e[n].name,e[n].value);else for(i in e)r(i,e[i]);return a};return r("",t).join("&")}"object"==typeof e.exports?e.exports=t:(o=function(){return t}.apply(n,[]))===undefined||(e.exports=o)}()},function(t,e,n){"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(){var t=0<arguments.length&&arguments[0]!==undefined?arguments[0]:{};this.state=t,this.publish={}}Object.defineProperty(e,"__esModule",{value:!0}),(e["default"]=o).prototype.on=function(t,e){this.publish[t]||(this.publish[t]=[]),this.publish[t].push(e)},o.prototype.emit=function(t,e){console.log("EMIT#",t,e),this.publish[t]&&0<this.publish[t].length&&this.publish[t].forEach(function(t){return t(e)})},o.prototype.setState=function(t){var e=this.state;this.state=function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(n,!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},this.state,{},t),this.emit("change",{oldState:e,newState:this.state}),console.log("state changed",this.state)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SEND_CREDENTIALS=e.SETTING_TOKEN=void 0;e.SETTING_TOKEN="SC_ITG";e.SEND_CREDENTIALS="__SC_SEND_CREDENTIALS__"}]);</script></body>
</html>
